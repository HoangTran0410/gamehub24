import{a as e,j as s}from"./index-BnUAJw6e.js";import{l as t,a4 as n,A as l,X as a,a5 as i,Q as r,o,a9 as c}from"./react-vendor-DuHYuIQj.js";import"./socket-DRbsQkF5.js";import"./zustand-BR1a1S03.js";function d({game:d,currentUserId:h}){const x=d,[m,g]=t.useState(x.getState()),[u,p]=t.useState(!1),{ti:b,ts:v}=e();t.useEffect(()=>{x.onUpdate(g),g(x.getState()),x.requestSync()},[x]);const j=x.getMyPlayerIndex(),f=j>=0?m.players[j].color:null,w=m.players[m.currentPlayerIndex],y=w?.id===h,N="playing"===m.gamePhase&&y?x.getValidMoves(f):[],k=x.getPieceCount(),q=x.isHostUser,C=(e,s)=>N.some(([t,n])=>t===e&&n===s),P=(e,t,n)=>{const l=C(t,n),a=m.lastMove?.row===t&&m.lastMove?.col===n,i=m.flippedCells?.some(e=>e.row===t&&e.col===n);return s.jsxs("button",{onClick:()=>((e,s)=>{"playing"===m.gamePhase&&y&&C(e,s)&&x.requestMove(e,s)})(t,n),className:`\n          aspect-square flex items-center justify-center\n          bg-green-700 border border-green-800\n          ${l?"cursor-pointer hover:bg-green-600":"cursor-default"}\n          ${a?"ring-2 ring-yellow-400 ring-inset":""}\n        `,disabled:!l,children:[e&&s.jsx("div",{className:`\n              w-[80%] h-[80%] rounded-full shadow-lg\n              ${"black"===e?"bg-gray-900":"bg-white"}\n              ${a?"scale-110":""}\n              ${i?"animate-flip":""}\n            `,style:i?{animation:"flip 0.4s ease-in-out"}:void 0}),!e&&l&&s.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]},`${t}-${n}`)};return s.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-2xl mx-auto pb-14",children:[u?s.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/80 p-4",onClick:()=>p(!1),children:s.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-2xl w-full max-h-[90%] flex flex-col shadow-2xl border border-slate-600",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx(c,{className:"w-6 h-6 text-yellow-500"}),b({en:"Game Rules",vi:"Luáº­t ChÆ¡i"})]}),s.jsx("button",{onClick:()=>p(!1),className:"p-1 hover:bg-slate-700 rounded transition-colors text-white",children:s.jsx(a,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar text-slate-300",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{children:b({en:"Reversi (Othello) is a strategy board game for two players, played on an 8Ã—8 uncheckered board.",vi:"Reversi (Othello) lÃ  trÃ² chÆ¡i chiáº¿n thuáº­t cho 2 ngÆ°á»i, chÆ¡i trÃªn bÃ n cá» 8x8."})}),s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:b({en:"Objective",vi:"Má»¥c tiÃªu"})}),s.jsx("ul",{className:"list-disc pl-5 space-y-1",children:s.jsx("li",{children:b({en:"Have the majority of disks on the board turned to display your color when the last playable empty square is filled.",vi:"Chiáº¿m Ä‘Æ°á»£c nhiá»u Ã´ trÃªn bÃ n cá» nháº¥t báº±ng mÃ u cá»§a mÃ¬nh khi trÃ² chÆ¡i káº¿t thÃºc."})})}),s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:b({en:"Gameplay",vi:"Luáº­t chÆ¡i"})}),s.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[s.jsx("li",{children:b({en:"Players take turns placing disks on the board with their assigned color facing up.",vi:"NgÆ°á»i chÆ¡i láº§n lÆ°á»£t Ä‘áº·t quÃ¢n cá» cá»§a mÃ¬nh lÃªn bÃ n."})}),s.jsx("li",{children:b({en:"During a play, any disks of the opponent's color that are in a straight line and bounded by the disk just placed and another disk of the current player's color are turned over to the current player's color.",vi:"Náº¿u báº¡n Ä‘áº·t quÃ¢n cá» káº¹p giá»¯a quÃ¢n Ä‘á»‘i phÆ°Æ¡ng (hÃ ng ngang, dá»c, chÃ©o), cÃ¡c quÃ¢n Ä‘Ã³ sáº½ bá»‹ láº­t sang mÃ u cá»§a báº¡n."})}),s.jsx("li",{children:b({en:"If you cannot make a valid move (capture at least one opponent's disk), you must pass your turn.",vi:"Náº¿u khÃ´ng cÃ³ nÆ°á»›c Ä‘i há»£p lá»‡ (Äƒn Ã­t nháº¥t 1 quÃ¢n), báº¡n pháº£i bá» lÆ°á»£t."})})]}),s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:b({en:"Winning",vi:"Chiáº¿n tháº¯ng"})}),s.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[s.jsx("li",{children:b({en:"The game ends when neither player can move.",vi:"TrÃ² chÆ¡i káº¿t thÃºc khi cáº£ 2 bÃªn khÃ´ng cÃ²n nÆ°á»›c Ä‘i."})}),s.jsx("li",{children:b({en:"The player with the most disks on the board wins.",vi:"NgÆ°á»i cÃ³ nhiá»u quÃ¢n cá» nháº¥t trÃªn bÃ n sáº½ tháº¯ng."})})]})]})})]})}):null,s.jsx("style",{dangerouslySetInnerHTML:{__html:"\n@keyframes flip {\n  0% { transform: rotateY(0deg) scale(1); }\n  50% { transform: rotateY(90deg) scale(1.1); }\n  100% { transform: rotateY(180deg) scale(1); }\n}\n"}}),s.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full max-w-md",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:b({en:"Players",vi:"NgÆ°á»i chÆ¡i"})}),m.players.map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-700 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-6 h-6 rounded-full ${"black"===e.color?"bg-gray-900":"bg-white"} ${"black"===e.color?"text-white":"text-black"}`,children:"black"===e.color?k.black:k.white}),s.jsxs("span",{className:"text-white",children:[e.id?e.username:"(waiting...)",e.isBot&&" ðŸ¤–"]})]}),e.isBot&&q&&s.jsx("button",{onClick:()=>x.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:b({en:"Remove",vi:"XÃ³a"})}),q&&!m.players[t].id&&s.jsxs("button",{onClick:()=>x.requestAddBot(),className:"flex items-center gap-2 p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[s.jsx(n,{className:"w-4 h-4"}),b({en:"Add Bot",vi:"ThÃªm Bot"})]})]},t))]}),"playing"===m.gamePhase&&s.jsxs("div",{className:"text-lg text-gray-400",children:[y?s.jsx("span",{className:"text-green-400",children:b({en:"Your turn!",vi:"LÆ°á»£t cá»§a báº¡n!"})}):s.jsxs("span",{children:[b({en:"Waiting for",vi:"Äang chá»"})," ",w?.username," ",b({en:"...",vi:"..."})]}),0===N.length&&y&&s.jsx("span",{className:"ml-2 text-yellow-400",children:b({en:"No valid moves - must pass",vi:"KhÃ´ng cÃ³ nÆ°á»›c Ä‘i há»£p lá»‡ - pháº£i bá» lÆ°á»£t"})})]}),m.undoRequest&&m.undoRequest.fromId!==h&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-xl max-w-sm mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:b({en:"Undo Request",vi:"YÃªu cáº§u hoÃ n tÃ¡c"})}),s.jsxs("p",{className:"text-gray-400 mb-4",children:[m.undoRequest.fromName," ",b({en:"wants to undo their last move",vi:"muá»‘n hoÃ n tÃ¡c nÆ°á»›c Ä‘i vá»«a rá»“i"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>x.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(l,{className:"w-4 h-4"})," ",b({en:"Accept",vi:"Äá»“ng Ã½"})]}),s.jsxs("button",{onClick:()=>x.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors",children:[s.jsx(a,{className:"w-4 h-4"})," ",b({en:"Decline",vi:"Tá»« chá»‘i"})]})]})]})}),m.undoRequest&&m.undoRequest.fromId===h&&s.jsx("div",{className:"text-yellow-400 text-sm",children:b({en:"Waiting for opponent to accept undo...",vi:"Äang chá» Ä‘á»‘i thá»§ cháº¥p nháº­n hoÃ n tÃ¡c..."})}),"ended"===m.gamePhase&&s.jsxs("div",{className:"text-center p-4 bg-slate-800 rounded-lg",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:b({en:"Game Over!",vi:"TrÃ² chÆ¡i káº¿t thÃºc!"})}),s.jsx("p",{className:"text-gray-300 mb-4",children:"draw"===m.winner?b({en:"It's a draw!",vi:"HÃ²a!"}):m.winner===h?b({en:"ðŸŽ‰ You won!",vi:"ðŸŽ‰ Báº¡n Ä‘Ã£ tháº¯ng!"}):`${m.players.find(e=>e.id===m.winner)?.username}{" "}\n                  ${b({en:"wins!",vi:"tháº¯ng!"})}`}),s.jsxs("p",{className:"text-gray-400",children:[b({en:"Black",vi:"Äen"}),": ",k.black," |"," ",b({en:"White",vi:"Tráº¯ng"}),": ",k.white]})]}),s.jsxs("div",{className:"flex gap-3",children:["waiting"===m.gamePhase&&s.jsx(s.Fragment,{children:q&&x.canStartGame()&&s.jsxs("button",{onClick:()=>x.requestStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(i,{className:"w-4 h-4"})," ",b({en:"Start Game",vi:"Báº¯t Ä‘áº§u"})]})}),"playing"===m.gamePhase&&s.jsxs(s.Fragment,{children:[y&&0===N.length&&s.jsx("button",{onClick:()=>x.requestPass(),className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-white rounded-lg transition-colors",children:b({en:"Pass Turn",vi:"Bá» lÆ°á»£t"})}),j>=0&&m.moveHistory.length>0&&!m.undoRequest&&s.jsxs("button",{onClick:()=>x.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[s.jsx(r,{className:"w-4 h-4"})," ",b({en:"Undo",vi:"HoÃ n tÃ¡c"})]})]}),"ended"===m.gamePhase&&s.jsxs("button",{onClick:()=>x.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(o,{className:"w-4 h-4"})," ",b({en:"Play Again",vi:"ChÆ¡i láº¡i"})]})]}),s.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:v({en:"Rules",vi:"Luáº­t chÆ¡i"}),children:s.jsx(c,{size:24})}),s.jsx("div",{className:"grid grid-cols-8 gap-0 rounded-lg overflow-hidden shadow-xl border-4 border-green-900 w-full max-w-[500px]",children:m.board.map((e,s)=>e.map((e,t)=>P(e,s,t)))})]})}export{d as default};
