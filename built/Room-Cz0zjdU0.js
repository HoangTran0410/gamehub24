const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TicTacToeUI-CgawK8La.js","./index-CYYyLRSM.js","./react-vendor-DJuGDrwg.js","./socket-DRbsQkF5.js","./zustand-DbB79pZ7.js","./index-B8AuIEpP.css","./registry-C4xPWhbb.js","./chess-DTd62Tay.js","./alertStore-BNMfrhCk.js","./CaroUI-2dmET5Cj.js","./ChessUI-B9hco3Ks.js","./chessground-CpDKPGt0.js","./ChessUI-D1wC9UDJ.css","./YouTubeWatchUI-OeQgOA-v.js","./CanvasGameUI-Bpr3fB8N.js"])))=>i.map(i=>d[i]);
import{u as e,g as s,j as t,l as a,_ as r}from"./index-CYYyLRSM.js";import{b as o,S as n,e as i,u as l,A as c,C as m}from"./react-vendor-DJuGDrwg.js";import{u as d,T as x,C as u,a as p,Y as f,b as g,c as h}from"./registry-C4xPWhbb.js";import{c as j}from"./zustand-DbB79pZ7.js";import{u as y}from"./alertStore-BNMfrhCk.js";const b=j(e=>({messages:[],addMessage:s=>e(e=>({messages:[...e.messages,s]})),clearMessages:()=>e({messages:[]}),setMessages:s=>e({messages:s})}));function v(){const[a,r]=o.useState(""),i=o.useRef(null),{messages:l,addMessage:c}=b(),{currentRoom:m}=d(),{userId:x,username:u}=e(),p=s();o.useEffect(()=>(p.on("chat:message",e=>{c(e)}),m&&p.emit("chat:history",{roomId:m.id},e=>{e.forEach(e=>c(e))}),()=>{p.off("chat:message")}),[p,c,m]),o.useEffect(()=>{i.current?.scrollIntoView({behavior:"smooth"})},[l]);const f=()=>{if(!a.trim()||!m)return;const e={roomId:m.id,userId:x,username:u,message:a.trim(),type:"user"};p.emit("chat:message",e),r("")};return t.jsxs("div",{className:"glass-card rounded-2xl flex flex-col h-[600px]",children:[t.jsxs("div",{className:"p-4 border-b border-white/10",children:[t.jsxs("h3",{className:"text-sm font-semibold text-text-secondary mb-3",children:["PLAYERS (",m?.players.length||0,"/",m?.maxPlayers||0,")"]}),t.jsx("div",{className:"space-y-2",children:m?.players.map(e=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-neon-green"}),t.jsxs("span",{className:"text-sm text-text-primary",children:[e.username,e.isHost&&" ðŸ‘‘"]})]},e.id))})]}),t.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-3",children:[l.map(e=>"system"===e.type?t.jsx(I,{message:e},e.id):t.jsx(N,{message:e,isHost:e.userId===m?.ownerId},e.id)),t.jsx("div",{ref:i})]}),t.jsx("div",{className:"p-4 border-t border-white/10",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:a,onChange:e=>r(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),f())},placeholder:"Type a message...",className:"flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),t.jsx("button",{onClick:f,disabled:!a.trim(),className:"p-2 bg-primary hover:bg-primary-light disabled:bg-primary/30 disabled:cursor-not-allowed text-white rounded-lg transition-colors cursor-pointer","aria-label":"Send message",children:t.jsx(n,{className:"w-5 h-5"})})]})})]})}function N({message:e,isHost:s}){const a=new Date(e.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-xs font-bold text-primary",children:e.username[0].toUpperCase()})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[t.jsxs("span",{className:"font-semibold text-text-primary text-sm truncate",children:[e.username,s?" ðŸ‘‘":""]}),t.jsx("span",{className:"text-xs text-text-muted flex-shrink-0",children:a})]}),t.jsx("p",{className:"text-text-secondary text-sm break-words text-left",children:e.message})]})]})}function I({message:e}){return t.jsx("div",{className:"flex items-center justify-center my-2",children:t.jsx("div",{className:"px-4 py-1.5 bg-white/5 border border-white/10 rounded-full text-xs text-text-muted",children:e.message})})}const w=j(e=>({gameInstance:null,gameState:null,isHost:!1,setGameInstance:s=>e({gameInstance:s}),updateGameState:s=>e({gameState:s}),setIsHost:s=>e({isHost:s})})),_=a(()=>r(()=>import("./TicTacToeUI-CgawK8La.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url),{fallback:t.jsx("div",{children:"Loading TicTacToe..."})}),T=a(()=>r(()=>import("./CaroUI-2dmET5Cj.js"),__vite__mapDeps([9,1,2,3,4,5]),import.meta.url),{fallback:t.jsx("div",{children:"Loading Caro..."})}),k=a(()=>r(()=>import("./ChessUI-B9hco3Ks.js"),__vite__mapDeps([10,1,2,3,4,5,7,11,12]),import.meta.url),{fallback:t.jsx("div",{children:"Loading Chess..."})}),E=a(()=>r(()=>import("./YouTubeWatchUI-OeQgOA-v.js"),__vite__mapDeps([13,1,2,3,4,5]),import.meta.url),{fallback:t.jsx("div",{children:"Loading YouTube..."})}),S=a(()=>r(()=>import("./CanvasGameUI-Bpr3fB8N.js"),__vite__mapDeps([14,1,2,3,4,5]),import.meta.url),{fallback:t.jsx("div",{children:"Loading Canvas..."})});function L(){const{currentRoom:a}=d(),{userId:r}=e(),{gameInstance:n,setGameInstance:i,setIsHost:l}=w(),c=s(),[m,j]=o.useState(null);return o.useEffect(()=>{if(!a)return;if(n&&n.roomId===a.id){const e=a.ownerId===r;l(e),n.updatePlayers(a.players)}else(()=>{n&&n.destroy();const e=a.gameType,s=h(e);if(!s)return j(`Game "${e}" not found`),void i(null);j(null);const t=a.ownerId===r;l(t);const o=s.createGame(a.id,c,t,r,a.players);i(o)})()},[a?.id,a?.gameType,a?.players,r,c,i,l]),o.useEffect(()=>()=>{w.getState().gameInstance?.destroy(),w.getState().setGameInstance(null)},[]),a?m?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-text-secondary",children:m})}):n?n instanceof x?t.jsx(_,{game:n}):n instanceof u?t.jsx(T,{game:n}):n instanceof p?t.jsx(k,{game:n}):n instanceof f?t.jsx(E,{game:n}):n instanceof g?t.jsx(S,{game:n,currentUserId:r}):t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-text-muted",children:"Unknown game type"})}):t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-text-muted",children:"Loading game..."})}):t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-text-muted",children:"No room selected"})})}const C=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{roomId:a}=i(),r=l(),{currentRoom:n,setCurrentRoom:x,updatePlayers:u}=d(),{clearMessages:p}=b(),{userId:f}=e(),{show:g}=y(),h=s();if(o.useEffect(()=>{if(!a)return void r("/");if(n?.id===a)return void console.log("Already have room data, skipping join");let e=!1,s=null;const t=()=>{e||(e=!0,console.log("Attempting to join room:",a,"socket.id:",h.id),s=setTimeout(()=>{console.log("Join timeout - callback never received"),e=!1},5e3),h.emit("room:join",{roomId:a},t=>{console.log("room:join response:",t),s&&clearTimeout(s),t.success&&t.room?x(t.room):(e=!1,g(t.error||"Failed to join room",{type:"error"}),r("/"))}))},o=()=>{console.log("Socket connected, will attempt join"),setTimeout(t,100)};return h.connected?t():(console.log("Socket not connected, waiting..."),h.on("connect",o)),()=>{h.off("connect",o),s&&clearTimeout(s)}},[a,h,r,x]),o.useEffect(()=>{if(a)return h.on("room:players",e=>{u(e)}),h.on("room:update",e=>{x(e)}),h.on("room:deleted",e=>{g(e.reason||"Room deleted by host",{type:"info",title:"Room Closed"}),x(null),p(),r("/")}),()=>{h.off("room:players"),h.off("room:update"),h.off("room:deleted")}},[a,h,u,x,r,p]),!n)return t.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:t.jsx("div",{className:"text-center",children:t.jsx("p",{className:"text-text-secondary",children:"Loading room..."})})});const j=n.ownerId===f;return t.jsxs("div",{className:"min-h-screen bg-background-primary",children:[t.jsx("header",{className:"md:sticky md:top-0 z-40 glass-card border-b border-white/10",children:t.jsx("div",{className:"max-w-7xl mx-auto px-2 md:px-4 py-2 md:py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>{h.emit("room:leave",{roomId:a}),x(null),p(),r("/")},className:"p-2 hover:bg-white/10 rounded-lg transition-colors cursor-pointer","aria-label":"Leave room",children:t.jsx(c,{className:"w-5 h-5 text-text-secondary"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-display text-text-primary",children:n.name}),t.jsx("p",{className:"text-sm text-text-muted capitalize",children:n.gameType})]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx(m,{className:"w-4 h-4"}),t.jsxs("span",{children:["Host:"," ",n.players.find(e=>e.id===n.ownerId)?.username," ",j?"(You)":""]})]})]})})}),t.jsx("main",{className:"max-w-7xl mx-auto px-2 md:px-4 py-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-6",children:[t.jsx("div",{className:"glass-card rounded-2xl p-2 md:p-4",children:t.jsx(L,{})}),t.jsx(v,{})]})})]})}},Symbol.toStringTag,{value:"Module"}));export{C as R,b as u};
