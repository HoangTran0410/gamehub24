import{u as e,j as t,f as r}from"./index-D_yeMUtc.js";import{c as n,ag as a,U as s,aY as l,aZ as o,z as c,ax as i,az as u,aA as d,aU as f,aV as h,a_ as g,a8 as x,aD as m}from"./react-vendor-CyPxdFQK.js";import"./BaseGame-CUocZOZQ.js";import{G as p,i as y,P as b,g as v,c as w,W as j,a as M,d as N,e as k}from"./constants-BOOtHh4-.js";import{u as T}from"./useGameState-CG4d3mB9.js";import"./socket-DRbsQkF5.js";import"./zustand-BbtpVoJv.js";let L=performance.now(),A=0;function R({game:R}){const I=R,{ts:C,ti:E}=e(),[Y]=T(I),[P,S]=n.useState({width:800,height:600}),[z,X]=n.useState(!1),[O,D]=n.useState(!0),G=Y.tanks[Y.currentTurnIndex],W=G?I.getVisualTank(G):void 0,F=I.isMyTurn(),[B,_]=n.useState(45),[U,q]=n.useState(50),V=n.useRef(null),H=n.useRef(null);n.useEffect(()=>{V.current=B},[B]),n.useEffect(()=>{H.current=U},[U]);const Z=n.useRef(null),K=n.useRef(null),$=n.useRef(null),J=n.useRef([]),Q=n.useRef(null),ee=n.useRef(!0),te=n.useRef(!0),re=n.useRef({width:0,height:0});n.useEffect(()=>{te.current=O},[O]);const ne=n.useRef({x:0,y:0,vx:0,vy:0,zoom:.8,targetZoom:.8,mode:"FOLLOW_PLAYER"}),ae=n.useRef({isDragging:!1,startX:0,startY:0,startCamX:0,startCamY:0,lastX:0,lastY:0,lastTime:0,startPinchDist:0,startZoom:1}),se=n.useRef({left:!1,right:!1}),le=n.useRef(new Map),oe=n.useRef(null),ce=n.useRef(P);n.useEffect(()=>{ce.current=P},[P]),n.useEffect(()=>{if(0===J.current.length)for(let e=0;e<50;e++)J.current.push({x:2e3*Math.random(),y:1200*Math.random(),size:2*Math.random()+.5,alpha:.6*Math.random()+.2})},[]),n.useEffect(()=>()=>{Q.current&&cancelAnimationFrame(Q.current)},[]);const ie=n.useRef(!1);n.useEffect(()=>{if("WAITING"===Y.phase)return void(ie.current=!1);if(ie.current)return;ie.current=!0;const e=$.current;if(!e)return;const t=I.initShaderRenderer(e);ee.current=t,t?console.log("GPU terrain rendering enabled"):console.warn("GPU rendering unavailable, using CPU fallback")},[I,Y.phase]),n.useEffect(()=>{const e=()=>{if(Z.current){const e=z?Z.current.clientHeight:.7*window.innerHeight;S({width:Z.current.clientWidth,height:e})}},t=new ResizeObserver(e);Z.current&&t.observe(Z.current),window.addEventListener("resize",e),e();const r=()=>{X(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",r),()=>{t.disconnect(),window.removeEventListener("resize",e),document.removeEventListener("fullscreenchange",r)}},[Y.phase,z]),n.useEffect(()=>{console.warn("useEffect loop");const e=()=>{const e=K.current;if(!e)return;const r=e.getContext("2d",{alpha:!0});if(!r)return;(()=>{const e=ce.current.width,t=ce.current.height,r=ne.current.zoom,n=ne.current.targetZoom;let a=r;Math.abs(n-r)>1e-4&&(a=r+.1*(n-r),ne.current.zoom=a);const s=e/a,l=t/a,o=s/2,c=l/2;if(ae.current.isDragging)ne.current.mode="MANUAL";else if("MANUAL"===ne.current.mode){if(ne.current.x+=ne.current.vx,ne.current.y+=ne.current.vy,ne.current.vx*=.95,ne.current.vy*=.95,Math.abs(ne.current.vx)<.1&&(ne.current.vx=0),Math.abs(ne.current.vy)<.1&&(ne.current.vy=0),Math.abs(a-r)>1e-4){const n=ne.current.x+e/2/r,a=ne.current.y+t/2/r;ne.current.x=n-o,ne.current.y=a-c}}else{let e=ne.current.x,t=ne.current.y;if(I.state.phase===p.IMPACT);else if("FOLLOW_PROJECTILE"===ne.current.mode&&I.projectiles.length>0){const r=I.projectiles;if(r.length>0)e=r.reduce((e,t)=>e+t.x,0)/r.length-o,t=r.reduce((e,t)=>e+t.y,0)/r.length-c;else{const r=I.state.tanks[I.state.currentTurnIndex];r&&(e=r.x-o,t=r.y-c)}}else if("FOLLOW_PLAYER"===ne.current.mode){const r=I.state.tanks[I.state.currentTurnIndex];if(r){const n=I.getVisualTank(r);e=n.x-o,t=n.y-c}}else if("FOLLOW_TANK"===ne.current.mode&&oe.current){const r=I.state.tanks.find(e=>e.id===oe.current);if(r&&r.health>0){const n=I.getVisualTank(r);e=n.x-o,t=n.y-c;const a=50;n.x>=ne.current.x+a&&n.x<=ne.current.x+s-a&&n.y>=ne.current.y+a&&n.y<=ne.current.y+l-a&&(oe.current=null,ne.current.mode="MANUAL")}else oe.current=null,ne.current.mode="FOLLOW_PLAYER"}ne.current.x+=.08*(e-ne.current.x),ne.current.y+=.08*(t-ne.current.y)}const i=Math.max(0,j-s);ne.current.x=Math.max(0,Math.min(ne.current.x,i));const u=M-l,d=-M;ne.current.y=Math.max(d,Math.min(ne.current.y,u))})();const{width:l,height:o}=ce.current,c=ne.current.zoom,i=ne.current.x,u=ne.current.y,d=I.getTerrainShaderRenderer(),f=te.current&&ee.current&&d?.isReady();if(r.clearRect(0,0,l,o),!f){const e=r.createLinearGradient(0,0,0,o);e.addColorStop(0,"#020617"),e.addColorStop(1,"#172554"),r.fillStyle=e,r.fillRect(0,0,l,o),r.fillStyle="#ffffff";for(const t of J.current){const e=((t.x-.05*i)%l+l)%l,n=((t.y-.05*u)%o+o)%o;r.globalAlpha=t.alpha,r.beginPath(),r.arc(e,n,t.size,0,2*Math.PI),r.fill()}r.globalAlpha=1}if(r.save(),r.scale(c,c),r.translate(-i,-u),f&&d){const e=$.current;e&&(re.current.width===l&&re.current.height===o&&e.width===l&&e.height===o||(e.width=l,e.height=o,re.current={width:l,height:o},d.resize(l,o)),d.render(I.state.terrainSeed,i,u,l,o,c))}else{const e=I.getTerrainRenderer(),t=I.getTerrainMap();e&&t&&e.renderVisibleChunks(r,i,u,l,o,c,t)}const h=l/c,g=o/c,x=I.getParticleShaderRenderer();if(x&&x.isReady())x.render(I.particleData,I.particleCount,i,u,l,o,c);else{const e=50,t=I.particleData,n=I.particleCount;for(let a=0;a<n;a++){const n=a*b,s=t[n+0],l=t[n+1];if(s<i-e||s>i+h+e||l<u-e||l>u+g+e)continue;const o=t[n+4],c=t[n+6],d=t[n+11],f=Math.round(255*t[n+8]),x=Math.round(255*t[n+9]),m=Math.round(255*t[n+10]);r.save(),r.globalAlpha=o,d>.5&&(r.globalCompositeOperation="lighter"),r.fillStyle=`rgb(${f},${x},${m})`,r.beginPath(),r.arc(s,l,c,0,2*Math.PI),r.fill(),r.restore()}}const m=100;for(const n of I.state.tanks){if(n.health<=0)continue;const e=I.getVisualTank(n);if(e.x<i-m||e.x>i+h+m||e.y<u-m||e.y>u+g+m)continue;const a=e.playerId===I.userId;t(r,e,a?V.current??e.angle:e.angle,c)}for(const t of I.projectiles){if(!t.active)continue;if(t.x<i-50||t.x>i+h+50||t.y<u-50||t.y>u+g+50)continue;r.save();const e=y.find(e=>e.type===t.weapon)?.color||"#38bdf8";r.beginPath(),r.arc(t.x,t.y,5,0,2*Math.PI),r.fillStyle=e,r.fill(),r.fillStyle="#fff",r.beginPath(),r.arc(t.x,t.y,2,0,2*Math.PI),r.fill(),r.restore()}const v=I.state.tanks[I.state.currentTurnIndex];if(v&&I.state.phase===p.AIMING){const e=I.getVisualTank(v),t=I.isMyTurn();n(r,e,t?V.current??v.angle:v.angle,t?H.current??v.power:v.power)}r.restore(),a(r,i,u,c,l,o),s(r)},t=(e,t,r,n)=>{e.save(),e.translate(t.x,t.y),e.fillStyle=t.color,e.beginPath(),e.arc(0,-10,15,0,Math.PI,!0),e.fillRect(-15,-10,30,10),e.fill(),e.fillStyle="#1e293b",e.fillRect(-18,-5,36,8),e.fillStyle="#475569";for(let s=-15;s<15;s+=6)e.beginPath(),e.arc(s+3,-1,2,0,2*Math.PI),e.fill();e.save(),e.translate(0,-10);const a=r*Math.PI/180;if(e.rotate(-a),e.fillStyle="#e2e8f0",e.fillRect(0,-3,25,6),e.restore(),e.save(),e.scale(1/n,1/n),e.translate(0,-40*n),e.fillStyle="#ffffff",e.font="bold 12px Arial",e.textAlign="center",e.fillText(t.name,0,-10),e.fillStyle="#334155",e.fillRect(-20,0,40,6),e.fillStyle=t.health>30?"#4ade80":"#ef4444",e.fillRect(-19,1,t.health/t.maxHealth*38,4),e.translate(0,8),e.fillStyle="#334155",e.fillRect(-20,0,40,4),e.fillStyle="#f59e0b",e.fillRect(-19,1,t.fuel/v*38,2),I.state.tanks[I.state.currentTurnIndex]?.id===t.id){e.beginPath(),e.moveTo(0,-15),e.lineTo(-6,-23),e.lineTo(6,-23),e.fillStyle="#facc15",e.fill();const r=w[t.weapon];r&&(e.fillStyle=r.color,e.font="bold 12px Arial",e.textAlign="center",e.fillText(r.name,0,-35))}e.restore(),e.restore()},n=(e,t,r,n)=>{e.beginPath(),e.moveTo(t.x,t.y-10);const a=r*Math.PI/180,s=n/100*N;let l=Math.cos(a)*s,o=-Math.sin(a)*s,c=t.x,i=t.y-10;for(let u=0;u<25;u++)c+=3*l,i+=3*o,o+=3*k,l+=3*I.state.wind,e.lineTo(c,i);e.strokeStyle="rgba(255, 255, 255, 0.4)",e.lineWidth=2,e.setLineDash([8,6]),e.stroke(),e.setLineDash([])},a=(e,t,n,a,s,l)=>{le.current.clear();const o=s/a,c=l/a,i=t+20,u=t+o-20,d=n+20,f=n+c-20;for(const h of I.state.tanks){if(h.health<=0)continue;const g=I.getVisualTank(h);if(g.x>=i&&g.x<=u&&g.y>=d&&g.y<=f)continue;let x=0,m=0;g.x<i?x=i-g.x:g.x>u&&(x=g.x-u),g.y<d?m=d-g.y:g.y>f&&(m=g.y-f);const p=Math.sqrt(x*x+m*m),y=t+o/2,b=n+c/2,v=g.x-y,w=g.y-b,j=Math.atan2(w,v),M=Math.max(25,Math.min(s-25,(g.x-t)*a)),N=Math.max(25,Math.min(l-25,(g.y-n)*a));e.save(),e.translate(M,N),e.save(),e.rotate(j),e.fillStyle=g.color||"#ef4444",e.beginPath(),e.moveTo(10,0),e.lineTo(-10,7),e.lineTo(-10,-7),e.fill(),e.restore(),e.fillStyle="#fff",e.font="bold 12px monospace",e.textAlign="center",e.textBaseline="middle",e.fillText(`${r(Math.round(p))}m`,0,20),e.restore(),le.current.set(g.id,{x:M,y:N,radius:25})}},s=e=>{e.fillStyle="#fff",e.font="bold 12px monospace",e.textAlign="left",e.textBaseline="top",e.fillText(`${A.toFixed(0)} FPS`,0,0)};return Q.current=requestAnimationFrame(function t(){const r=performance.now();let n=r-L;L=r,I.update(),A+=.1*(1e3/n-A),e(),Q.current=requestAnimationFrame(t)}),()=>{Q.current&&cancelAnimationFrame(Q.current)}},[]),n.useEffect(()=>{const e=e=>{"ArrowLeft"===e.key&&(se.current.left=!0),"ArrowRight"===e.key&&(se.current.right=!0)," "===e.key&&I.isMyTurn()&&I.state.phase===p.AIMING&&(e.preventDefault(),I.fire())},t=e=>{"ArrowLeft"===e.key&&(se.current.left=!1),"ArrowRight"===e.key&&(se.current.right=!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[I]);const ue=n.useCallback(e=>{if(console.log("move start"),I.state.phase!==p.AIMING||!I.isMyTurn())return;const t=I.getMyTank();t&&(t.isMoving&&t.moveDir===e||(console.log("inside move start"),t.isMoving=!0,t.moveDir=e,I.moveStart(e),ne.current.mode="FOLLOW_PLAYER"))},[I]),de=n.useCallback(e=>{const t=I.getMyTank();t&&t.isMoving&&t.moveDir===e&&I.moveStop()},[I]);n.useEffect(()=>{const e=e=>{e.repeat||("ArrowLeft"===e.key&&ue(-1),"ArrowRight"===e.key&&ue(1))},t=e=>{"ArrowLeft"===e.key&&de(-1),"ArrowRight"===e.key&&de(1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[I,ue,de]),n.useEffect(()=>{Y.phase===p.PROJECTILE_MOVING||Y.phase===p.FIRING||Y.phase===p.IMPACT?ne.current.mode="FOLLOW_PROJECTILE":Y.phase===p.AIMING&&(ne.current.mode="FOLLOW_PLAYER")},[Y.phase]);const fe=()=>{ae.current.isDragging=!1},he=e=>{const t=ne.current.targetZoom,r="in"===e?Math.min(t+.25,2.5):Math.max(t-.25,.4);ne.current.targetZoom=r};return Y.phase===p.WAITING?t.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gray-950 text-white p-4",children:[t.jsx("h1",{className:"text-4xl font-black mb-8 bg-gradient-to-r from-blue-400 to-purple-500 text-transparent bg-clip-text",children:"GunnyWars"}),t.jsxs("div",{className:"bg-gray-900 rounded-xl p-6 border border-gray-800 w-full max-w-md",children:[t.jsx("h2",{className:"text-lg font-bold mb-4",children:C({en:"Players",vi:"Người chơi"})}),t.jsxs("div",{className:"space-y-3",children:[Y.players.map((e,r)=>t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-800 rounded-lg",children:["BOT"===e.id?t.jsx(a,{size:18,className:"text-red-400"}):t.jsx(s,{size:18,className:0===r?"text-blue-400":"text-emerald-400"}),t.jsx("span",{className:"font-medium",children:e.username||C({en:"Waiting...",vi:"Đang đợi..."})}),0===r&&t.jsx("span",{className:"ml-auto text-xs text-gray-500",children:C({en:"Host",vi:"Chủ phòng"})}),"BOT"===e.id&&I.isHost&&t.jsx("button",{onClick:()=>I.requestRemoveBot(),className:"ml-auto text-red-400 hover:text-red-300 transition-colors p-2 bg-red-400/20 rounded-lg",children:t.jsx(l,{size:16})})]},(e.id||"bot")+r)),I.isHost&&t.jsxs("button",{onClick:()=>I.requestAddBot(),className:"w-full p-3 border border-dashed border-gray-700 rounded-lg text-gray-400 hover:text-white hover:border-gray-500 transition-all flex items-center justify-center gap-2",children:[t.jsx(o,{size:18}),C({en:"Add Bot",vi:"Thêm Bot"})]})]}),I.isHost&&t.jsxs("button",{onClick:()=>I.startGame(),disabled:!I.canStartGame(),className:"w-full mt-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-400 hover:to-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg font-bold flex items-center justify-center gap-2",children:[t.jsx(c,{size:20}),C({en:"Start Game",vi:"Bắt đầu"})]})]})]}):t.jsxs("div",{className:"w-full h-full flex flex-col font-sans bg-gray-950 text-gray-100 select-none overflow-hidden",children:[t.jsxs("div",{ref:Z,className:"flex-1 min-h-0 relative cursor-grab active:cursor-grabbing overflow-hidden touch-none "+(z?"":"h-[60vh]!"),onMouseDown:e=>{ae.current.isDragging=!0,ae.current.startX=e.clientX,ae.current.startY=e.clientY,ae.current.startCamX=ne.current.x,ae.current.startCamY=ne.current.y,ae.current.lastX=e.clientX,ae.current.lastY=e.clientY,ae.current.lastTime=performance.now(),ne.current.vx=0,ne.current.vy=0},onMouseMove:e=>{if(ae.current.isDragging){const t=performance.now(),r=Math.max(1,t-ae.current.lastTime),n=ne.current.zoom,a=(e.clientX-ae.current.startX)/n,s=(e.clientY-ae.current.startY)/n,l=(ae.current.lastX-e.clientX)/n*(16/r),o=(ae.current.lastY-e.clientY)/n*(16/r);ne.current.vx=.4*ne.current.vx+.6*l,ne.current.vy=.4*ne.current.vy+.6*o,ne.current.x=ae.current.startCamX-a,ne.current.y=ae.current.startCamY-s,ae.current.lastX=e.clientX,ae.current.lastY=e.clientY,ae.current.lastTime=t}},onMouseUp:fe,onMouseLeave:fe,onTouchStart:e=>{const t=e.touches[0];ae.current.isDragging=!0,ae.current.startX=t.clientX,ae.current.startY=t.clientY,ae.current.startCamX=ne.current.x,ae.current.startCamY=ne.current.y,ae.current.lastX=t.clientX,ae.current.lastY=t.clientY,ae.current.lastTime=performance.now(),ne.current.vx=0,ne.current.vy=0},onTouchMove:e=>{if(ae.current.isDragging){const t=performance.now(),r=Math.max(1,t-ae.current.lastTime),n=e.touches[0],a=ne.current.zoom,s=(n.clientX-ae.current.startX)/a,l=(n.clientY-ae.current.startY)/a,o=(ae.current.lastX-n.clientX)/a*(16/r),c=(ae.current.lastY-n.clientY)/a*(16/r);ne.current.vx=.4*ne.current.vx+.6*o,ne.current.vy=.4*ne.current.vy+.6*c,ne.current.x=ae.current.startCamX-s,ne.current.y=ae.current.startCamY-l,ae.current.lastX=n.clientX,ae.current.lastY=n.clientY,ae.current.lastTime=t}},onTouchEnd:e=>{if(0===e.touches.length)ae.current.isDragging=!1;else{const t=e.touches[0];ae.current.isDragging=!0,ae.current.startX=t.clientX,ae.current.startY=t.clientY,ae.current.startCamX=ne.current.x,ae.current.startCamY=ne.current.y}},children:[t.jsx("canvas",{ref:$,width:P.width,height:P.height,className:"absolute inset-0 block",style:{zIndex:0}}),t.jsx("canvas",{ref:K,width:P.width,height:P.height,className:"absolute inset-0 block",onClick:e=>{if(Math.sqrt(Math.pow(e.clientX-ae.current.startX,2)+Math.pow(e.clientY-ae.current.startY,2))>5)return;const t=K.current;if(!t)return;const r=t.getBoundingClientRect(),n=e.clientX-r.left,a=e.clientY-r.top;for(const[s,l]of le.current){const e=n-l.x,t=a-l.y;if(Math.sqrt(e*e+t*t)<=l.radius)return oe.current=s,void(ne.current.mode="FOLLOW_TANK")}},onTouchEnd:e=>{if(Math.sqrt(Math.pow((e.changedTouches[0]?.clientX||0)-ae.current.startX,2)+Math.pow((e.changedTouches[0]?.clientY||0)-ae.current.startY,2))>10)return;const t=K.current;if(!t||!e.changedTouches[0])return;const r=e.changedTouches[0],n=t.getBoundingClientRect(),a=r.clientX-n.left,s=r.clientY-n.top;for(const[l,o]of le.current){const e=a-o.x,t=s-o.y;if(Math.sqrt(e*e+t*t)<=o.radius)return oe.current=l,void(ne.current.mode="FOLLOW_TANK")}},style:{zIndex:1}}),t.jsx("div",{style:{width:P.width,height:P.height}}),t.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-black/50 backdrop-blur-md px-6 py-2 rounded-full border border-gray-700 flex items-center gap-3 shadow-lg pointer-events-none",children:[t.jsx("span",{className:"text-xs font-bold text-gray-400 tracking-wider",children:E({en:"WIND",vi:"GIÓ"})}),t.jsxs("span",{className:"font-mono font-bold text-lg "+(Y.wind>0?"text-green-400":"text-red-400"),children:[Math.abs(Math.round(100*Y.wind))," ",Y.wind>0?"→":"←"]})]}),t.jsxs("div",{className:"absolute bottom-4 right-4 flex flex-row gap-1 z-20 opacity-30 hover:opacity-100 transition-all duration-300",children:[t.jsx("button",{onClick:()=>I.requestRegenerateMap(),className:"bg-purple-800/80 hover:bg-purple-700 p-2 rounded-full border border-purple-600 text-purple-200 shadow-lg backdrop-blur-sm transition-transform active:scale-95",title:"Regenerate Map",children:t.jsx(i,{size:18})}),t.jsx("button",{onClick:()=>D(!O),className:"px-3 py-2 rounded-full border text-xs font-bold shadow-lg backdrop-blur-sm transition-all active:scale-95 "+(O?"bg-green-800/80 hover:bg-green-700 border-green-600 text-green-200":"bg-amber-800/80 hover:bg-amber-700 border-amber-600 text-amber-200"),children:O?"GPU":"CPU"}),t.jsx("button",{onClick:()=>he("in"),className:"bg-gray-800/80 hover:bg-gray-700 p-2 rounded-full border border-gray-600 text-white shadow-lg backdrop-blur-sm transition-transform active:scale-95",children:t.jsx(u,{size:18})}),t.jsx("button",{onClick:()=>he("out"),className:"bg-gray-800/80 hover:bg-gray-700 p-2 rounded-full border border-gray-600 text-white shadow-lg backdrop-blur-sm transition-transform active:scale-95",children:t.jsx(d,{size:18})}),t.jsx("button",{onClick:async()=>{document.fullscreenElement?(await document.exitFullscreen(),X(!1)):(await(Z.current?.parentElement?.requestFullscreen()),X(!0))},className:"bg-gray-800/80 hover:bg-gray-700 p-2 rounded-full border border-gray-600 text-white shadow-lg backdrop-blur-sm transition-transform active:scale-95",children:z?t.jsx(f,{size:18}):t.jsx(h,{size:18})})]}),t.jsxs("div",{className:"absolute top-4 right-4 text-gray-500 text-xs flex items-center gap-2 pointer-events-none opacity-50",children:[t.jsx(g,{size:14})," ",C({en:"Drag to pan camera",vi:"Kéo để di chuyển camera"})]}),Y.phase===p.GAME_OVER&&t.jsxs("div",{className:"absolute inset-0 bg-black/80 flex flex-col items-center justify-center z-50",children:[t.jsxs("h1",{className:"text-5xl @md:text-7xl font-black mb-6 bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-600 text-transparent bg-clip-text",children:[Y.winner," ",C({en:"WINS",vi:"THẮNG"})]}),t.jsxs("button",{onClick:()=>I.requestReset(),className:"px-10 py-4 bg-white text-black font-black text-xl tracking-widest hover:scale-105 transition-transform flex items-center gap-2",children:[t.jsx(i,{size:24}),C({en:"PLAY AGAIN",vi:"CHƠI LẠI"})]})]})]}),t.jsx("div",{className:"bg-gray-900 border-t border-gray-800 p-2 @md:p-4 shadow-[0_-10px_40px_rgba(0,0,0,0.5)] z-10 shrink-0",children:t.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col gap-3",children:[t.jsxs("div",{className:"grid grid-cols-12 gap-2 @md:gap-4 items-stretch",children:[t.jsx("div",{className:"col-span-12 @md:col-span-3 bg-gray-800/50 rounded-lg p-2 border border-gray-700 flex items-center justify-center gap-2",children:t.jsxs("div",{className:"flex items-center gap-2",children:[W?.isBot?t.jsx(a,{size:18,className:"text-red-400"}):t.jsx(s,{size:18,className:F?"text-blue-400":"text-red-400"}),t.jsx("span",{className:"font-bold uppercase tracking-wider text-xs @md:text-sm "+(F?"text-blue-400":"text-red-400"),children:Y.players.find(e=>e.tankId===W?.id)?.username||(W?.isBot?"Bot":C({en:"Turn",vi:"Lượt"}))})]})}),t.jsxs("div",{className:"col-span-6 @md:col-span-3 flex gap-1 "+(F&&Y.phase===p.AIMING?"":"opacity-40 pointer-events-none grayscale"),children:[t.jsx("button",{className:"flex-1 bg-gray-800 hover:bg-gray-700 active:bg-blue-600 active:text-white rounded border border-gray-700 flex items-center justify-center transition-colors",onMouseDown:()=>ue(-1),onMouseUp:()=>de(-1),onMouseLeave:()=>de(-1),onTouchStart:e=>{e.preventDefault(),ue(-1)},onTouchEnd:e=>{e.preventDefault(),de(-1)},children:t.jsx(x,{size:20})}),t.jsx("button",{className:"flex-1 bg-gray-800 hover:bg-gray-700 active:bg-blue-600 active:text-white rounded border border-gray-700 flex items-center justify-center transition-colors",onMouseDown:()=>ue(1),onMouseUp:()=>de(1),onMouseLeave:()=>de(1),onTouchStart:e=>{e.preventDefault(),ue(1)},onTouchEnd:e=>{e.preventDefault(),de(1)},children:t.jsx(m,{size:20})})]}),t.jsx("div",{className:"col-span-6 @md:col-span-6 "+(F&&Y.phase===p.AIMING?"":"opacity-40 pointer-events-none grayscale"),children:t.jsx("button",{onClick:()=>I.fire(),className:"w-full h-full min-h-[44px] bg-gradient-to-b from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-black text-lg tracking-widest rounded-lg shadow-lg active:scale-95 transition-transform border-t border-red-400 flex items-center justify-center",children:C({en:"FIRE",vi:"BẮN"})})})]}),t.jsxs("div",{className:"grid grid-cols-12 gap-2 @md:gap-4 items-center "+(F&&Y.phase===p.AIMING?"":"opacity-40 pointer-events-none grayscale"),children:[t.jsxs("div",{className:"col-span-12 @md:col-span-7 grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-gray-400",children:[t.jsx("span",{children:C({en:"ANG",vi:"GÓC"})}),t.jsxs("span",{className:"text-blue-400",children:[Math.round(B??W?.angle??0),"°"]})]}),t.jsx("input",{type:"range",min:"0",max:"180",value:180-(B??W?.angle??0),onChange:e=>{const t=180-parseInt(e.target.value);_(t)},onMouseUp:()=>{null!==B&&(I.commitAngle(B),_(null))},onTouchEnd:()=>{null!==B&&(I.commitAngle(B),_(null))},className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),t.jsxs("div",{className:"flex-1 space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-gray-400",children:[t.jsx("span",{children:C({en:"PWR",vi:"LỰC"})}),t.jsx("span",{className:"text-red-400",children:Math.round(U??W?.power??0)})]}),t.jsx("input",{type:"range",min:"0",max:"100",value:U??W?.power??0,onChange:e=>{const t=parseInt(e.target.value);q(t)},onMouseUp:()=>{null!==U&&(I.commitPower(U),q(null))},onTouchEnd:()=>{null!==U&&(I.commitPower(U),q(null))},className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-500"})]})]}),t.jsx("div",{className:"col-span-12 @md:col-span-5 flex gap-1 overflow-x-auto pb-1 no-scrollbar",children:y.map(e=>t.jsx("button",{onClick:()=>I.selectWeapon(e.type),className:"flex-1 min-w-[60px] py-1.5 text-[10px] font-bold border rounded transition-all whitespace-nowrap cursor-pointer hover:bg-slate-600",style:{backgroundColor:W?.weapon===e.type?e.color:void 0,borderColor:W?.weapon===e.type?e.color:void 0,color:W?.weapon===e.type?"white":"#9ca3af"},children:e.name},e.type))})]})]})})]})}export{R as default};
