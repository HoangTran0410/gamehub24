import{j as e}from"./index-CeYqN8mD.js";import{i as s,Z as t,l as a}from"./react-vendor-8M2Qp7q7.js";import"./socket-DRbsQkF5.js";import"./zustand-Co1j1e9s.js";import"./chess-DTd62Tay.js";const l={red:"bg-red-500/60",blue:"bg-blue-500/60"},r={red:"text-red-500",blue:"text-blue-500"};function n({game:n,currentUserId:i}){const[o,d]=s.useState(n.getState());s.useEffect(()=>{n.onUpdate(d),d(n.getState()),n.requestSync()},[n]);const c=o.players[o.currentPlayerIndex],x=c?.id===i,m=o.isGameEnded,u=100/(o.gridSize-1);return e.jsxs("div",{className:"flex flex-col items-center gap-6 p-4 w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Dots & Boxes"}),m||"playing"!==o.gamePhase?m?e.jsxs("div",{className:"text-2xl font-bold text-white mb-2",children:["Game Over!"," ","draw"===o.winner?"It's a Draw!":`${o.players.find(e=>e.id===o.winner)?.username} Wins!`]}):null:e.jsx("div",{className:"text-lg",children:x?e.jsx("span",{className:"text-green-400 font-bold animate-pulse",children:"Your Turn!"}):e.jsxs("span",{className:"text-gray-300",children:["Waiting for"," ",e.jsx("span",{className:`${r[c.color]} font-bold`,children:c.username}),"..."]})}),e.jsx("div",{className:"flex gap-4 md:gap-8 bg-slate-800 p-4 rounded-xl shadow-lg border border-slate-700 w-full justify-center",children:o.players.map((s,t)=>e.jsxs("div",{className:`flex flex-col items-center gap-2 p-2 rounded-lg transition-all ${o.currentPlayerIndex!==t||m?"border-2 border-transparent":"bg-slate-700 scale-105 shadow-md border-2 "+("red"===s.color?"border-red-500":"border-blue-500")} ${s.id?"":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full "+("red"===s.color?"bg-red-500":"bg-blue-500")}),e.jsx("div",{className:"text-sm font-bold "+("red"===s.color?"text-red-500":"text-blue-500"),children:s.id?s.username:"Empty"})]}),s.id?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:"text-3xl font-black "+("red"===s.color?"text-red-500":"text-blue-500"),children:s.score})}):e.jsx("div",{className:"h-9 flex items-center",children:e.jsx("span",{className:"text-gray-500 text-xs italic",children:"Waiting..."})}),n.isHostUser&&!m&&o.boxes.every(e=>e.every(e=>null===e))&&e.jsx("div",{className:"mt-1",children:s.isBot?e.jsx("button",{onClick:()=>n.requestRemoveBot(t),className:"text-xs bg-red-900 hover:bg-red-800 text-red-100 px-2 py-1 rounded",children:"Remove Bot"}):!s.id&&e.jsx("button",{onClick:()=>n.requestAddBot(t),className:"text-xs bg-cyan-900 hover:bg-cyan-800 text-cyan-100 px-2 py-1 rounded",children:"+ Add Bot"})})]},`player-${t}`))})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[!m&&"waiting"===o.gamePhase&&n.isHostUser&&e.jsxs("button",{onClick:()=>n.requestStartGame(),disabled:!n.canStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(t,{className:"w-4 h-4"})," Start Game"]}),n.isHostUser&&"waiting"!==o.gamePhase&&e.jsxs("button",{onClick:()=>n.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:[e.jsx(a,{className:"w-4 h-4"})," ",m?"Play Again":"New Game"]}),"playing"===o.gamePhase&&!m&&e.jsx("button",{onClick:()=>n.requestUndo(),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg",children:"Undo"})]}),o.undoRequest&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg shadow-xl border border-slate-600 flex flex-col gap-3",children:[e.jsxs("p",{className:"text-white",children:[o.players.find(e=>e.id===o.undoRequest?.requesterId)?.username," ","requested to undo the last move."]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>n.rejectUndo(),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded",children:"Reject"}),e.jsx("button",{onClick:()=>n.approveUndo(),className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white rounded",children:"Approve"})]})]})}),e.jsx("div",{className:"relative aspect-square w-full max-w-[400px] bg-slate-900 p-6 rounded-lg shadow-2xl select-none touch-none border-2 border-slate-700",children:e.jsxs("div",{className:"relative w-full h-full",children:[o.boxes.map((s,t)=>s.map((s,a)=>{const n=o.players.find(e=>e.id===s);return n?e.jsx("div",{className:`absolute flex items-center justify-center rounded-sm transition-all duration-500 scale-90 ${l[n.color]}`,style:{top:t*u+"%",left:a*u+"%",width:`${u}%`,height:`${u}%`},children:e.jsx("div",{className:`text-2xl font-bold ${r[n.color]}`,children:n.username[0].toUpperCase()})},`box-${t}-${a}`):null})),["horizontal","vertical"].map(s=>("horizontal"===s?o.horizontalLines:o.verticalLines).map((t,a)=>t.map((t,l)=>{const r=o.lastLine?.type===s&&o.lastLine.row===a&&o.lastLine.col===l,i="horizontal"===s;return e.jsx("div",{onClick:()=>{return e=s,t=a,r=l,void(x&&!m&&"playing"===o.gamePhase&&("horizontal"===e&&o.horizontalLines[t][r]||"vertical"===e&&o.verticalLines[t][r]||n.requestPlaceLine(e,t,r)));var e,t,r},className:`absolute cursor-pointer transition-all duration-200 rounded-full z-10\n                      ${i?"h-2 -translate-y-1/2":"w-2 -translate-x-1/2"}\n                      ${t?r?"bg-yellow-400 shadow-[0_0_12px_4px_rgba(250,204,21,0.7)] animate-pulse":"bg-white shadow-[0_0_8px_2px_rgba(255,255,255,0.4)]":"playing"===o.gamePhase?"bg-slate-700 hover:bg-slate-400":"bg-slate-800 cursor-default"}`,style:{top:a*u+"%",left:l*u+"%",...i?{width:`${u}%`}:{height:`${u}%`}},children:!t&&"playing"===o.gamePhase&&e.jsx("div",{className:"absolute inset-0 "+(i?"-top-2 -bottom-2":"-left-2 -right-2")})},`${s[0]}-${a}-${l}`)})))]})})]})}export{n as default};
