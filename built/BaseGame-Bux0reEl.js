import"./socket-DRbsQkF5.js";class t{roomId;socket;isHost;userId;constructor(t,e,s,a){this.roomId=t,this.socket=e,this.isHost=s,this.userId=a,this.isHost||this.socket.on("game:state",this.handleStateSync.bind(this)),this.socket.on("game:action",this.handleAction.bind(this))}get isHostUser(){return this.isHost}get getRoomId(){return this.roomId}gameName="unknown";setGameName(t){this.gameName=t}broadcastState(){if(this.isHost){const t=this.getState();this.socket.emit("game:state",{roomId:this.roomId,state:{...t}}),this.saveStateToStorage()}}sendAction(t){this.socket.emit("game:action",{roomId:this.roomId,action:t})}handleStateSync(t){this.isHost||this.setState(t.state)}broadcastGameEnd(t){this.socket.emit("game:end",{roomId:this.roomId,result:t}),this.clearSavedState()}saveStateToStorage(){if(this.isHost&&"unknown"!==this.gameName)try{const t=`saved_game_${this.gameName}`,e={state:this.getState(),timestamp:Date.now()};localStorage.setItem(t,JSON.stringify(e))}catch(t){console.error("Failed to save game state:",t)}}clearSavedState(){if(this.isHost&&"unknown"!==this.gameName)try{localStorage.removeItem(`saved_game_${this.gameName}`)}catch(t){console.error("Failed to clear game state:",t)}}destroy(){this.socket.off("game:state"),this.socket.off("game:action")}}export{t as B};
